(()=>{"use strict";const t=/^[A-Z]/;class e{constructor(){this.registration={}}register(t,e){this.registration[t]=e,e.engine=this}getEntries(e){return e?Object.entries(e).filter((([e])=>e.match(t))).sort((([t],[e])=>t.localeCompare(e))).map((([t,e])=>({name:t,auxiliary:e,processor:this.registration[t]}))):[]}process(t){var e,n,i,o,s,r;return i=this,o=void 0,r=function*(){if(!t)return void console.warn("No entity to process.");for(const{processor:t}of this.getEntries(this.entity))yield null===(e=null==t?void 0:t.onExit)||void 0===e?void 0:e.call(t);this.entity=t;const i=this.getEntries(t);for(const{name:e,processor:o,auxiliary:s}of i)o||console.warn(`No processor for auxiliary: ${e}`),yield null===(n=null==o?void 0:o.process)||void 0===n?void 0:n.call(o,s,t)},new((s=void 0)||(s=Promise))((function(t,e){function n(t){try{a(r.next(t))}catch(t){e(t)}}function c(t){try{a(r.throw(t))}catch(t){e(t)}}function a(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(n,c)}a((r=r.apply(i,o||[])).next())}))}}const n=JSON.parse('{"$schema":"../entity.json","Workspace":{"apps":[{"Name":"hello-world-app","Title":"Hello World Application","Application":{"scenes":[{"Name":"hello-world-scene","Message":"Hello World"}]}},{"Name":"hello-world-app-2","Title":"Hello World Application 2","Application":{"scenes":[{"Name":"hello-world-scene","Message":"Hello World"}]}}]}}');class i{onExit(){return t=this,e=void 0,i=function*(){},new((n=void 0)||(n=Promise))((function(o,s){function r(t){try{a(i.next(t))}catch(t){s(t)}}function c(t){try{a(i.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i}}var o=function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{a(i.next(t))}catch(t){s(t)}}function c(t){try{a(i.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}a((i=i.apply(t,e||[])).next())}))};class s extends i{constructor(){super(...arguments),this.active=!1,this.div=document.createElement("div"),this.refresh=()=>{}}process(t,e){return o(this,void 0,void 0,(function*(){this.refresh=()=>{this.render(this.div,t,e),this.active&&requestAnimationFrame(this.refresh)},(null==t?void 0:t.initiallyInactive)||this.setActive(!0),yield this.onCreate()}))}setActive(t){this.active=t,this.active&&requestAnimationFrame(this.refresh)}onCreate(){return o(this,void 0,void 0,(function*(){document.body.appendChild(this.div)}))}onExit(){return o(this,void 0,void 0,(function*(){document.body.removeChild(this.div),this.setActive(!1)}))}}class r extends s{constructor(t){super(),this.listProperty=t}getEntities(t){const e=t[this.listProperty];return Array.isArray(e)?e:[]}process(t,e){const n=Object.create(null,{process:{get:()=>super.process}});var i,o,s,r,c,a;return s=this,r=void 0,a=function*(){yield n.process.call(this,t,e);const s=this.getEntities(t)[null!==(i=t.index)&&void 0!==i?i:-1];s&&(yield null===(o=this.engine)||void 0===o?void 0:o.process(s))},new((c=void 0)||(c=Promise))((function(t,e){function n(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof c?o:new c((function(t){t(o)}))).then(n,i)}o((a=a.apply(s,r||[])).next())}))}render(t,e,n){t.innerText="",this.getEntities(e).forEach((e=>{const n=t.appendChild(document.createElement("div"));n.style.color="blue",n.style.textDecoration="underline",n.style.cursor="pointer",n.addEventListener("mousedown",(()=>{var t;null===(t=this.engine)||void 0===t||t.process(e)}));const i=e.Name;n.innerText=`${i}`}))}}class c extends r{constructor(){super("scenes")}}class a extends i{process(t){return e=this,n=void 0,o=function*(){const e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.backgroundColor="silver",e.style.width="100%",e.style.padding="5px",e.style.margin="0px",e.style.opacity=".8",e.style.cursor="pointer",e.addEventListener("mousedown",(()=>document.body.removeChild(e))),document.body.appendChild(e),e.textContent=`${t}`},new((i=void 0)||(i=Promise))((function(t,s){function r(t){try{a(o.next(t))}catch(t){s(t)}}function c(t){try{a(o.throw(t))}catch(t){s(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(r,c)}a((o=o.apply(e,n||[])).next())}));var e,n,i,o}}class l extends i{process(t){return e=this,n=void 0,o=function*(){document.title=t},new((i=void 0)||(i=Promise))((function(t,s){function r(t){try{a(o.next(t))}catch(t){s(t)}}function c(t){try{a(o.throw(t))}catch(t){s(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(r,c)}a((o=o.apply(e,n||[])).next())}));var e,n,i,o}}class u extends r{constructor(){super("apps")}}class d extends i{process(t){return e=this,n=void 0,o=function*(){this.property=t},new((i=void 0)||(i=Promise))((function(t,s){function r(t){try{a(o.next(t))}catch(t){s(t)}}function c(t){try{a(o.throw(t))}catch(t){s(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(r,c)}a((o=o.apply(e,n||[])).next())}));var e,n,i,o}}class h{static execute(t){t.register("Workspace",new u),t.register("Application",new c),t.register("Title",new l),t.register("Message",new a),t.register("Name",new d)}}const v={main:function(){return t=this,i=void 0,s=function*(){const t=new e;h.execute(t),yield t.process(n)},new((o=void 0)||(o=Promise))((function(e,n){function r(t){try{a(s.next(t))}catch(t){n(t)}}function c(t){try{a(s.throw(t))}catch(t){n(t)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(t){t(n)}))).then(r,c)}a((s=s.apply(t,i||[])).next())}));var t,i,o,s}};globalThis.exports=v})();
//# sourceMappingURL=main.js.map