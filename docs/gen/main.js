(()=>{var e={965:e=>{e.exports={FileUtils:class{constructor(e){this.XMLHttpRequest=e||globalThis.XMLHttpRequest,this.fileStock={}}async preload(...e){return Promise.all(e.map((async e=>await this.load(e))))}async load(e,t){return e?new Promise(((n,o)=>{const s=t||(e.match(/.(json)$/i)?"json":"blob"),i=[e,s].join("|");if(this.fileStock[i]){const{data:e,loaded:t,onLoadListeners:o}=this.fileStock[i];t?n(e):o.push(n)}else{const t=new this.XMLHttpRequest;this.fileStock[i]={data:null,url:e,progress:0,onLoadListeners:[]},t.open("GET",e),t.responseType=s,t.addEventListener("load",(s=>{if(200===t.status){const e=t.response;this.fileStock[i].progress=1,this.fileStock[i].loaded=!0,this.fileStock[i].data=e,this.fileStock[i].onLoadListeners.forEach((t=>t(e))),delete this.fileStock[i].onLoadListeners,n(e)}else o(new Error(`Url could not load: ${e}`))})),t.addEventListener("error",(e=>{o(new Error("Network Error"))})),t.addEventListener("progress",(e=>{this.fileStock[i].progress=e.loaded/e.total})),t.send()}})):Promise.resolve(null)}}}},847:e=>{e.exports={ImageLoader:class{constructor(e,t,n){this.preserve=e||{},this.XMLHttpRequest=t||globalThis.XMLHttpRequest,this.Image=n||globalThis.Image,this.imageStock={}}async getBlobUrl(e){return await this.loadImage(e),this.preserve[e]?this.imageStock[e]?.img.src:null}async preloadImages(...e){return Promise.all(e.map((async e=>await this.loadImage(e))))}async loadImage(e){return e?new Promise(((t,n)=>{if(this.imageStock[e]){const{img:n,loaded:o,onLoadListeners:s}=this.imageStock[e];o?t(n):s.push(t)}else{const o=new this.XMLHttpRequest,s=new this.Image;this.imageStock[e]={img:s,url:e,progress:0,onLoadListeners:[]},o.open("GET",e),o.responseType="blob",o.addEventListener("load",(s=>{if(200===o.status)if(e.match(/.(jpg|jpeg|png|gif)$/i)){const n=URL.createObjectURL(o.response),{img:s}=this.imageStock[e];s.addEventListener("load",(()=>{this.preserve[e]||URL.revokeObjectURL(n),this.imageStock[e].progress=1,this.imageStock[e].loaded=!0;const o=this.imageStock[e].onLoadListeners;delete this.imageStock[e].onLoadListeners,t(s),o.forEach((e=>e(s)))})),s.src=n}else n(new Error("Invalid image."));else n(new Error(`Url could not load: ${e}`))})),o.addEventListener("error",(e=>{n(new Error("Network Error"))})),o.addEventListener("progress",(t=>{this.imageStock[e].progress=t.loaded/t.total})),o.send()}})):Promise.resolve(null)}}}},128:(e,t,n)=>{const{FileUtils:o}=n(965),{ImageLoader:s}=n(847);e.exports={FileUtils:o,ImageLoader:s}}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}(()=>{"use strict";const e=/^[A-Z]/;class t{constructor(){this.registration={}}register(e,t){this.registration[e]=t,t.engine=this}getEntries(t){return t?Object.entries(t).filter((([t])=>t.match(e))).sort((([e],[t])=>e.localeCompare(t))).map((([e,t])=>({name:e,auxiliary:t,processor:this.registration[e]}))):[]}process(e){var t,n,o,s,i,r;return o=this,s=void 0,r=function*(){if(!e)return void console.warn("No entity to process.");for(const{processor:e}of this.getEntries(this.entity))yield null===(t=null==e?void 0:e.onExit)||void 0===t?void 0:t.call(e);this.entity=e;const o=this.getEntries(e);for(const{name:e,processor:t}of o)t||console.warn(`No processor for auxiliary: ${e}`);for(const{processor:t,auxiliary:n}of o)yield null==t?void 0:t.onCreate(n,e);for(const{processor:t,auxiliary:s}of o)yield null===(n=null==t?void 0:t.process)||void 0===n?void 0:n.call(t,s,e)},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{a(r.next(e))}catch(e){t(e)}}function c(e){try{a(r.throw(e))}catch(e){t(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof i?o:new i((function(e){e(o)}))).then(n,c)}a((r=r.apply(o,s||[])).next())}))}}var o=function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}a((o=o.apply(e,t||[])).next())}))};class s{onCreate(e,t){return o(this,void 0,void 0,(function*(){}))}onExit(){return o(this,void 0,void 0,(function*(){}))}}class i extends s{constructor(){super(...arguments),this.active=!1,this.refresh=()=>{}}process(e,t){return n=this,o=void 0,i=function*(){this.refresh=()=>{this.render(e,t),this.active&&requestAnimationFrame(this.refresh)},(null==e?void 0:e.initiallyInactive)||this.setActive(!0)},new((s=void 0)||(s=Promise))((function(e,t){function r(e){try{a(i.next(e))}catch(e){t(e)}}function c(e){try{a(i.throw(e))}catch(e){t(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(r,c)}a((i=i.apply(n,o||[])).next())}));var n,o,s,i}setActive(e){this.active=e,this.active&&requestAnimationFrame(this.refresh)}}var r=function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}a((o=o.apply(e,t||[])).next())}))};class c extends i{constructor(){super(...arguments),this.div=document.createElement("div")}onCreate(){return r(this,void 0,void 0,(function*(){document.body.appendChild(this.div)}))}onExit(){return r(this,void 0,void 0,(function*(){document.body.removeChild(this.div),this.setActive(!1)}))}}class a extends c{constructor(e){super(),this.listProperty=e}getEntities(e){const t=e[this.listProperty];return Array.isArray(t)?t:[]}activeElement(e){var t;return this.getEntities(e)[null!==(t=e.index)&&void 0!==t?t:-1]}process(e,t){const n=Object.create(null,{process:{get:()=>super.process}});var o,s,i,r,c;return s=this,i=void 0,c=function*(){yield n.process.call(this,e,t);const s=this.activeElement(e);s&&(yield null===(o=this.engine)||void 0===o?void 0:o.process(s))},new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{a(c.next(e))}catch(e){t(e)}}function o(e){try{a(c.throw(e))}catch(e){t(e)}}function a(t){var s;t.done?e(t.value):(s=t.value,s instanceof r?s:new r((function(e){e(s)}))).then(n,o)}a((c=c.apply(s,i||[])).next())}))}render(e,t){const n=this.div;n.innerText="",this.getEntities(e).forEach((e=>{const t=n.appendChild(document.createElement("div"));t.style.color="blue",t.style.textDecoration="underline",t.style.cursor="pointer",t.addEventListener("mousedown",(()=>{var t;null===(t=this.engine)||void 0===t||t.process(e)})),t.innerText=`${e.Id}`}))}}class l extends a{constructor(){super("scenes")}}class d extends s{process(e){return t=this,n=void 0,s=function*(){const t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.backgroundColor="silver",t.style.width="100%",t.style.padding="5px",t.style.margin="0px",t.style.opacity=".8",t.style.cursor="pointer",t.addEventListener("mousedown",(()=>document.body.removeChild(t))),document.body.appendChild(t),t.textContent=`${e}`},new((o=void 0)||(o=Promise))((function(e,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,c)}a((s=s.apply(t,n||[])).next())}));var t,n,o,s}}class u extends s{process(e){return t=this,n=void 0,s=function*(){document.title=e},new((o=void 0)||(o=Promise))((function(e,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,c)}a((s=s.apply(t,n||[])).next())}));var t,n,o,s}}class h extends a{constructor(){super("apps")}}class p extends s{process(e){return t=this,n=void 0,s=function*(){this.property=e},new((o=void 0)||(o=Promise))((function(e,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,c)}a((s=s.apply(t,n||[])).next())}));var t,n,o,s}}class v extends c{render(e,t){const n=this.div;n.innerText="";const o=n.appendChild(document.createElement("div"));o.style.color="blue",o.style.textDecoration="underline",o.style.cursor="pointer",o.addEventListener("mousedown",(()=>{var e;null===(e=this.engine)||void 0===e||e.process(t)})),o.innerText="Workspace"}}class f{static execute(e){e.register("Workspace",new h),e.register("Application",new l),e.register("Title",new u),e.register("Message",new d),e.register("Id",new p),e.register("Breadcrumbs",new v)}}var m=n(128);const y={main:function(){return e=this,n=void 0,s=function*(){const e=new t;f.execute(e);const n=new m.FileUtils(XMLHttpRequest),o=yield n.load("samples/hello-world.json","json");yield e.process(o)},new((o=void 0)||(o=Promise))((function(t,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,c)}a((s=s.apply(e,n||[])).next())}));var e,n,o,s}};globalThis.exports=y})()})();
//# sourceMappingURL=main.js.map