(()=>{var t={965:t=>{t.exports={FileUtils:class{constructor(t){this.XMLHttpRequest=t||globalThis.XMLHttpRequest,this.fileStock={}}async preload(...t){return Promise.all(t.map((async t=>await this.load(t))))}async load(t,e){return t?new Promise(((n,o)=>{const i=e||(t.match(/.(json)$/i)?"json":"blob"),s=[t,i].join("|");if(this.fileStock[s]){const{data:t,loaded:e,onLoadListeners:o}=this.fileStock[s];e?n(t):o.push(n)}else{const e=new this.XMLHttpRequest;this.fileStock[s]={data:null,url:t,progress:0,onLoadListeners:[]},e.open("GET",t),e.responseType=i,e.addEventListener("load",(i=>{if(200===e.status){const t=e.response;this.fileStock[s].progress=1,this.fileStock[s].loaded=!0,this.fileStock[s].data=t,this.fileStock[s].onLoadListeners.forEach((e=>e(t))),delete this.fileStock[s].onLoadListeners,n(t)}else o(new Error(`Url could not load: ${t}`))})),e.addEventListener("error",(t=>{o(new Error("Network Error"))})),e.addEventListener("progress",(t=>{this.fileStock[s].progress=t.loaded/t.total})),e.send()}})):Promise.resolve(null)}}}},847:t=>{t.exports={ImageLoader:class{constructor(t,e,n){this.preserve=t||{},this.XMLHttpRequest=e||globalThis.XMLHttpRequest,this.Image=n||globalThis.Image,this.imageStock={}}async getBlobUrl(t){return await this.loadImage(t),this.preserve[t]?this.imageStock[t]?.img.src:null}async preloadImages(...t){return Promise.all(t.map((async t=>await this.loadImage(t))))}async loadImage(t){return t?new Promise(((e,n)=>{if(this.imageStock[t]){const{img:n,loaded:o,onLoadListeners:i}=this.imageStock[t];o?e(n):i.push(e)}else{const o=new this.XMLHttpRequest,i=new this.Image;this.imageStock[t]={img:i,url:t,progress:0,onLoadListeners:[]},o.open("GET",t),o.responseType="blob",o.addEventListener("load",(i=>{if(200===o.status)if(t.match(/.(jpg|jpeg|png|gif)$/i)){const n=URL.createObjectURL(o.response),{img:i}=this.imageStock[t];i.addEventListener("load",(()=>{this.preserve[t]||URL.revokeObjectURL(n),this.imageStock[t].progress=1,this.imageStock[t].loaded=!0;const o=this.imageStock[t].onLoadListeners;delete this.imageStock[t].onLoadListeners,e(i),o.forEach((t=>t(i)))})),i.src=n}else n(new Error("Invalid image."));else n(new Error(`Url could not load: ${t}`))})),o.addEventListener("error",(t=>{n(new Error("Network Error"))})),o.addEventListener("progress",(e=>{this.imageStock[t].progress=e.loaded/e.total})),o.send()}})):Promise.resolve(null)}}}},128:(t,e,n)=>{const{FileUtils:o}=n(965),{ImageLoader:i}=n(847);t.exports={FileUtils:o,ImageLoader:i}}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var s=e[o]={exports:{}};return t[o](s,s.exports,n),s.exports}(()=>{"use strict";const t=/^[A-Z]/;class e{constructor(){this.registration={}}register(t,e){this.registration[t]=e,e.engine=this}getEntries(e){return e?Object.entries(e).filter((([e])=>e.match(t))).sort((([t],[e])=>t.localeCompare(e))).map((([t,e])=>({name:t,auxiliary:e,processor:this.registration[t]}))):[]}process(t){var e,n,o,i,s,r;return o=this,i=void 0,r=function*(){if(!t)return void console.warn("No entity to process.");for(const{processor:t}of this.getEntries(this.entity))yield null===(e=null==t?void 0:t.onExit)||void 0===e?void 0:e.call(t);this.entity=t;const o=this.getEntries(t);for(const{name:t,processor:e}of o)e||console.warn(`No processor for auxiliary: ${t}`);for(const{processor:e,auxiliary:n}of o)yield null==e?void 0:e.onCreate(n,t);for(const{processor:e,auxiliary:i}of o)yield null===(n=null==e?void 0:e.process)||void 0===n?void 0:n.call(e,i,t)},new((s=void 0)||(s=Promise))((function(t,e){function n(t){try{c(r.next(t))}catch(t){e(t)}}function a(t){try{c(r.throw(t))}catch(t){e(t)}}function c(e){var o;e.done?t(e.value):(o=e.value,o instanceof s?o:new s((function(t){t(o)}))).then(n,a)}c((r=r.apply(o,i||[])).next())}))}}var o=function(t,e,n,o){return new(n||(n=Promise))((function(i,s){function r(t){try{c(o.next(t))}catch(t){s(t)}}function a(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((o=o.apply(t,e||[])).next())}))};class i{onCreate(t,e){return o(this,void 0,void 0,(function*(){}))}onExit(){return o(this,void 0,void 0,(function*(){}))}}class s extends i{constructor(){super(...arguments),this.active=!1,this.refresh=()=>{}}process(t,e){return n=this,o=void 0,s=function*(){this.refresh=()=>{const n=this.render(t,e);this.active&&n&&requestAnimationFrame(this.refresh)},"object"==typeof t&&(null==t?void 0:t.initiallyInactive)||this.setActive(!0)},new((i=void 0)||(i=Promise))((function(t,e){function r(t){try{c(s.next(t))}catch(t){e(t)}}function a(t){try{c(s.throw(t))}catch(t){e(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(r,a)}c((s=s.apply(n,o||[])).next())}));var n,o,i,s}setActive(t){this.active=t,this.active&&requestAnimationFrame(this.refresh)}}var r=function(t,e,n,o){return new(n||(n=Promise))((function(i,s){function r(t){try{c(o.next(t))}catch(t){s(t)}}function a(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((o=o.apply(t,e||[])).next())}))};class a extends s{constructor(){super(...arguments),this.div=document.createElement("div")}onCreate(){return r(this,void 0,void 0,(function*(){document.body.appendChild(this.div)}))}onExit(){return r(this,void 0,void 0,(function*(){document.body.removeChild(this.div),this.setActive(!1)}))}addLink(t,e){const n=this.div.appendChild(document.createElement("div"));n.style.color=e?"blue":"",n.style.textDecoration=e?"underline":"",n.style.cursor=e?"pointer":"",e&&n.addEventListener("mousedown",e),n.innerText=t}}class c extends a{constructor(t){super(),this.listProperty=t}getEntities(t){const e=t[this.listProperty];return Array.isArray(e)?e:[]}process(t,e){const n=Object.create(null,{process:{get:()=>super.process}});return o=this,i=void 0,r=function*(){yield n.process.call(this,t,e);const o=e;o.isContainer=()=>!0,o.getEntities=()=>this.getEntities(t),o.getActiveEntity=()=>{var t,n;return null===(t=o.getEntities)||void 0===t?void 0:t.call(o)[null!==(n=e.index)&&void 0!==n?n:-1]},o.setActiveEntity=t=>{var e,n;return o.index=null===(n=null===(e=o.getEntities)||void 0===e?void 0:e.call(o))||void 0===n?void 0:n.indexOf(t)},o.getEntities().forEach((t=>t.parent=e))},new((s=void 0)||(s=Promise))((function(t,e){function n(t){try{c(r.next(t))}catch(t){e(t)}}function a(t){try{c(r.throw(t))}catch(t){e(t)}}function c(e){var o;e.done?t(e.value):(o=e.value,o instanceof s?o:new s((function(t){t(o)}))).then(n,a)}c((r=r.apply(o,i||[])).next())}));var o,i,s,r}render(t,e){var n;this.div.innerText="";const o=e;null===(n=o.getEntities)||void 0===n||n.call(o).forEach((t=>{this.addLink(`${null==t?void 0:t.Id}`,(()=>{var e,n;null===(e=o.setActiveEntity)||void 0===e||e.call(o,t),null===(n=this.engine)||void 0===n||n.process(t)}))}))}}class l extends c{constructor(){super("scenes")}}class d extends a{render(t,e){const n=this.div;n.style.position="absolute",n.style.left="0px",n.style.backgroundColor="silver",n.style.width="100%",n.style.padding="10px",n.style.margin="0px",n.style.opacity=".8",n.textContent=`${t}`}}class u extends i{process(t){return e=this,n=void 0,i=function*(){document.title=t},new((o=void 0)||(o=Promise))((function(t,s){function r(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(r,a)}c((i=i.apply(e,n||[])).next())}));var e,n,o,i}}class h extends c{constructor(){super("apps")}}class v extends i{constructor(t){super(),this.name=t}process(t,e){return n=this,o=void 0,s=function*(){e[this.name]=t},new((i=void 0)||(i=Promise))((function(t,e){function r(t){try{c(s.next(t))}catch(t){e(t)}}function a(t){try{c(s.throw(t))}catch(t){e(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(r,a)}c((s=s.apply(n,o||[])).next())}));var n,o,i,s}}class p extends a{onCreate(){return t=this,e=void 0,o=function*(){document.body.insertBefore(this.div,document.body.firstChild)},new((n=void 0)||(n=Promise))((function(i,s){function r(t){try{c(o.next(t))}catch(t){s(t)}}function a(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((o=o.apply(t,e||[])).next())}));var t,e,n,o}render(t,e){const n=[];for(let t=e;t;t=t.parent)n.unshift(t);const o=this.div;o.innerText="",o.style.display="flex",o.style.flexDirection="row";for(let i=0;i<n.length;i++)0!==i&&this.addSeparator(o,t),this.addComponent(n[i],n[i]!==e)}addSeparator(t,e){const n=t.appendChild(document.createElement("div"));n.style.margin="0 5px",n.innerText=e}addComponent(t,e){this.addLink(`${null==t?void 0:t.Id}`,e?()=>{var e;null===(e=this.engine)||void 0===e||e.process(t)}:void 0)}}class f{static execute(t){t.register("Workspace",new h),t.register("Application",new l),t.register("Title",new u),t.register("Message",new d),t.register("Id",new v("id")),t.register("Breadcrumbs",new p)}}var g=n(128);const y={main:function(){return t=this,n=void 0,i=function*(){const t=new e;f.execute(t);const n=new g.FileUtils(XMLHttpRequest),o=yield n.load("samples/hello-world.json","json");yield t.process(o),globalThis.root=o,globalThis.engine=t},new((o=void 0)||(o=Promise))((function(e,s){function r(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(t){t(n)}))).then(r,a)}c((i=i.apply(t,n||[])).next())}));var t,n,o,i}};globalThis.exports=y})()})();
//# sourceMappingURL=main.js.map